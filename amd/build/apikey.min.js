define("tool_vault/apikey",["exports","core_form/dynamicform","core/pending","core/notification"],(function(_exports,_dynamicform,_pending,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Allows to enter API key
   *
   * @module     tool_vault/apikey
   * @copyright  2023 Marina Glancy
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_dynamicform=_interopRequireDefault(_dynamicform),_pending=_interopRequireDefault(_pending),_notification=_interopRequireDefault(_notification);const openApikeyForm=function(){let apikey=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",autoSubmit=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const pendingPromise=new _pending.default("tool_vault/apikeyform:open");closeLoginSignupModal();const formContainer=document.getElementById("getapikey_formplaceholder"),apikeyForm=new _dynamicform.default(formContainer,"\\tool_vault\\form\\apikey_form");apikeyForm.addEventListener(apikeyForm.events.FORM_SUBMITTED,(()=>location.reload())),apikeyForm.load({apikey:apikey}).then((()=>(autoSubmit&&apikeyForm.submitFormAjax(),pendingPromise.resolve()))).catch(_notification.default.exception)},openLoginSignupModal=()=>{document.getElementById("getapikey_formplaceholder").innerHTML="";const loginSignupButton=document.getElementById("getapikey_loginsignup"),loginSignupIframe=document.getElementById("getapikey_iframe"),url=loginSignupButton&&loginSignupIframe?loginSignupButton.dataset.target:null;loginSignupIframe.src=url,loginSignupIframe.style.display="block"},closeLoginSignupModal=()=>{const loginSignupIframe=document.getElementById("getapikey_iframe");loginSignupIframe.style.display="none",loginSignupIframe.src="about:blank"};_exports.init=()=>{const loginSignupButton=document.getElementById("getapikey_loginsignup"),enterApikeyButton=document.getElementById("getapikey_enterapikey"),loginSignupIframe=document.getElementById("getapikey_iframe"),url=loginSignupButton&&loginSignupIframe?loginSignupButton.dataset.target:null;if(!url)return;const urlHost=url.match(/^(https?:\/\/[^/]+)(.*)$/)[1];loginSignupButton.onclick=openLoginSignupModal,enterApikeyButton.onclick=()=>openApikeyForm(),window.addEventListener("message",(event=>{event.origin===urlHost&&event.data&&"object"==typeof event.data&&("apikey"===event.data.action?openApikeyForm(event.data.apikey,!0):"close"===event.data.action&&closeLoginSignupModal())}),!1)}}));

//# sourceMappingURL=apikey.min.js.map
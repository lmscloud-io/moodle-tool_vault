function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)
/**
 * AMD module for older versions of Moodle
 *
 * @module     tool_vault/apikey_amd
 * @copyright  2024 Marina Glancy
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */}define("tool_vault/apikey_amd",[],(function(){var SELECTORS_APIKEY_FORM_CONTAINER="#getapikey_formplaceholder",SELECTORS_APIKEY_IFRAME="#getapikey_iframe",SELECTORS_SIGNIN_BUTTON="#getapikey_signin",SELECTORS_SIGNUP_BUTTON="#getapikey_signup",SELECTORS_ENTER_KEY_BUTTON="#getapikey_enterapikey",SELECTORS_LEGACY_FORM_CONTAINER="#getapikey_legacyform",openLoginSignupModal=function(e){document.querySelector(SELECTORS_APIKEY_FORM_CONTAINER).innerHTML="";var formContainer=document.querySelector(SELECTORS_LEGACY_FORM_CONTAINER);formContainer&&formContainer.classList.add("hidden");var signInButton=e.target,loginSignupIframe=document.querySelector(SELECTORS_APIKEY_IFRAME),url=signInButton&&loginSignupIframe?signInButton.dataset.target:null;loginSignupIframe.src=url,loginSignupIframe.style.display="block"},closeLoginSignupModal=function(){var loginSignupIframe=document.querySelector(SELECTORS_APIKEY_IFRAME);loginSignupIframe.style.display="none",loginSignupIframe.src="about:blank"},openApikeyForm=function(apikey,autoSubmit){closeLoginSignupModal();var formContainer=document.querySelector(SELECTORS_LEGACY_FORM_CONTAINER);formContainer.classList.remove("hidden"),apikey&&""!==apikey&&(formContainer.querySelector('input[name="apikey"]').value=apikey,autoSubmit&&formContainer.querySelector('input[name="submitbutton"]').click())};return{init:function(){!function(onMessage){var signInButton=document.querySelector(SELECTORS_SIGNIN_BUTTON),signUpButton=document.querySelector(SELECTORS_SIGNUP_BUTTON),loginSignupIframe=document.querySelector(SELECTORS_APIKEY_IFRAME),url=signInButton&&loginSignupIframe?signInButton.dataset.target:null;if(url){var urlHost=url.match(/^(https?:\/\/[^/]+)(.*)$/)[1];signInButton.onclick=openLoginSignupModal,signUpButton&&(signUpButton.onclick=openLoginSignupModal),document.querySelector(SELECTORS_ENTER_KEY_BUTTON).addEventListener("click",(function(){closeLoginSignupModal()})),window.addEventListener("message",(function(event){event.origin===urlHost&&event.data&&"object"===_typeof(event.data)&&("close"===event.data.action?closeLoginSignupModal():onMessage(event))}),!1)}}((function(event){"apikey"===event.data.action&&openApikeyForm(event.data.apikey,!0)})),document.querySelector(SELECTORS_ENTER_KEY_BUTTON).addEventListener("click",(function(){openApikeyForm()}))}}}));

//# sourceMappingURL=apikey_amd.min.js.map